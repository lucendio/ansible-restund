[Unit]
Description=restund
Requires=network-online.target
After=network-online.target
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
ExecStartPre=-/usr/bin/docker kill restund
ExecStartPre=-/usr/bin/docker rm restund
ExecStart=/usr/bin/docker run \
  --ulimit nofile=90000:90000 \
  --network=host \
  --name restund \
  --cap-add=NET_BIND_SERVICE \
  --sysctl net.ipv4.ip_unprivileged_port_start=0 \
  --user {{ restund_uid }}:{{ restund_user }} \
  --volume /etc/restund:/usr/local/etc/restund:ro \
  quay.io/wire/restund:{{ restund_version }}

[Install]
WantedBy=multi-user.target
